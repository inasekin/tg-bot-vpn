# VPN Telegram Bot

[![Maintainability](https://qlty.sh/gh/inasekin/projects/tg-bot-vpn/maintainability.svg)](https://qlty.sh/gh/inasekin/projects/tg-bot-vpn)

Telegram-бот для управления VPN конфигурациями через WireGuard. Позволяет пользователям создавать, управлять и удалять VPN конфигурации для разных устройств.

## Возможности

- Создание нескольких VPN конфигураций (до 5) для одного пользователя
- Скачивание конфигураций в формате WireGuard
- Просмотр профиля и списка конфигураций
- Управление конфигурациями
- Статистика для администратора
- Автоматическое распределение IP адресов
- Криптографическая генерация ключей X25519
- Настроен автоматический деплой на сервер, а так же CI для проверки линтера

## Требования

- Python 3.9 или выше
- WireGuard установлен на сервере
- Telegram Bot Token
- Docker (опционально)

## Установка

### С использованием uv

```bash
uv sync
```

### С использованием pip

```bash
pip install -r requirements.txt
```

## Конфигурация

Создайте файл `.env` в корне проекта:

```env
BOT_TOKEN=your_telegram_bot_token_here
WG_SERVER_PUBLIC_KEY=your_server_public_key_here
WG_SERVER_ENDPOINT=your_server_ip:51820
ADMIN_ID=your_telegram_user_id
```

## Запуск

```bash
uv run python src/main.py
```

## Команды бота

- `/start` - Начать работу с ботом
- `Получить VPN` - Создать новую VPN конфигурацию
- `Мой профиль` - Просмотреть профиль и список конфигов
- `Управлять VPN` - Управлять существующими конфигурациями
- `/stats` - Просмотреть статистику (только для админа)


## Как это работает

1. Пользователь нажимает "Получить VPN"
2. Бот предлагает выбрать название конфигурации
3. Генерируются криптографические ключи X25519
4. Выделяется IP адрес из пула
5. Конфигурация сохраняется в БД и добавляется на WireGuard сервер
6. Пользователю отправляется конфиг-файл для импорта в приложение WireGuard


## Лимиты

- Максимум 5 конфигураций на пользователя
- Максимум 254 IP адреса в пуле (10.0.0.2 - 10.0.0.254)
- Уникальные имена конфигураций на пользователя